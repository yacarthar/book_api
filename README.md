
# Book API

A Restful API for book management, using FastAPI framework and Postgresql database.

**Live demo**:

https://main-bvxea6i-is5cxz4lczpvk.au.platformsh.site/api/v1/books/?page=1&limit=5


## Run Locally

Clone the project

```bash
  git clone https://github.com/yacarthar/book_api.git
```
Go to the project directory
```bash
  cd book_api
```

Create a virtual environment. This step may vary on your machine and your Python environment tools. For example, using virtualenv on Windows:
```bash
  virtualenv env
  env\Scripts\activate
```

Install dependencies
```bash
  pip install -r requirements.txt
```

### Requisite
- A Postgresql database up and running for the local environment.
- Another Postgresql database for functional tests.

### Environment Variables

To run/test this project Locally, you must add the following environment variables to your `local.env` file or `.test.env` (when you run tests).

I recommend you look up `.env.example` for more detail.

`SECRET_KEY`: enter your random string.

`APP_BASE_URL`: default is "http://localhost:8000"

`DB_USERNAME`: your Postgresql database username

`DB_PASSWORD`: your Postgresql database password

`DB_HOST`: your Postgresql host

`DB_PORT`: default is 5432

`DB_PATH`: your Postgresql database name

### Scripts

For the first time running locally or every time update the database table, you have to migrate model changes into the database:
- Alembic migration:
```cmd
alembic upgrade head
```

Choose your scripts based on your local machine's OS.
For example, run scripts on Windows:
- Start server local:
```cmd
scripts\start_local.cmd
```

- Test scripts:
```cmd
scripts\test_run.cmd
```

- Format source code:
```cmd
scripts\format.cmd
```
## API Reference

#### Get all books

```HTTP
  GET /api/v1/books
```

| Parameter | Type     | Example            | Default |
| :-------- | :------- | :------------------|:--------|
| `title`   | `string` | adventure          |         |
| `author`  | `string` | George             |         |
| `date`    | `string` | before2018-11-04   |         |
| `page`    | `int`    | 3                  |   1     |
| `limit`   | `int`    | 5                  |   5     |

- Filter Date before time
    - use param: `date=beforeYYYY-MM-DD`
    - http://localhost:8000/books/?title=en&date=before2022-11-09&page=10&limit=5
- Filter Date after time
    - use param: `date=afterYYYY-MM-DD`
    - http://localhost:8000/books/?title=en&date=after2014-11-19&page=10&limit=5
- Filter Date exact time
    - use param: `date=YYYY-MM-DD`
    - http://localhost:8000/books/?title=en&date=2017-10-04&page=10&limit=5

#### Login

```HTTP
  POST /api/v1/users
```

| JSON Body | Type     | Description |
| :-------- | :------- | :-----------|
| `email`   | `string` | **Required**|
| `password`| `string` | **Required**|



#### Full Redoc document

- http://127.0.0.1:8000/api/v1/redoc
- https://main-bvxea6i-is5cxz4lczpvk.au.platformsh.site/api/v1/redoc

#### OpenAPI JSON

- http://127.0.0.1:8000/api/v1/openapi.json
- https://main-bvxea6i-is5cxz4lczpvk.au.platformsh.site/api/v1/openapi.json
## Features

- CRUD book items:
    - Read item, Update & Delete Item
    - List items with pagination
        - Filter by keyword
        - Filter by date
- Authenticate User with Bearer Token:
    - Protected routes: Create Book, Delete Book, Update Book
- CI/CD:
    - Job only deploys after all tests passed
- Tests:
    - Functional tests: test if all endpoints work as expected when communicating with a test database
    - Endpoint tests: test each endpoint in isolation, with Mock Class.
- Redoc Documentation
    - Documentation autogenerated by default
    - Access at `/api/v1/redoc`

## Documentation

[Documentation](https://github.com/yacarthar/book_api/tree/main/docs)

- Diagrams
    - DB Diagrams
    - Sequence Diagrams
    - Components Diagrams
- OpenAPI JSON file
    - Postman collections compatibility
## Tech Stack

**Framwork:** Python, FastAPI

**Database:** Postgresql

**Hosting:** Platform.sh

**CI/CD:** GitHub Actions

## Feedback

If you have any feedback, please reach out to us at hoang.pham.vbhp@gmail.com

